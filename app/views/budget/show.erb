<div id="current_budget_content">
  <table class="table table-striped table-bordered table-hover table-condensed">
    <h4>Budget Sumary: </h4>
    <tr>
      <td>Budget time period</td>
      <td><%= @budget_wrapper.time_period %></td>
    </tr>
    <tr>
      <td>Spending limit</td>
      <td>£ <%= @budget_wrapper.spending_limit %></td>
    </tr>
    <tr>
      <td>Total expenses</td>
      <td>£ <%= @budget_wrapper.total_spending%></td>
    </tr>
    <tr>
      <td>Overspent?</td>
      <td><%= @budget_wrapper.overspent? %></td>
    </tr>
  </table>
  <br />
  <h4>Total spending per category: </h4>
  <table class="table table-striped table-bordered table-hover table-condensed">
    <% if @budget_wrapper.categories_with_totals.nil? %>
      <tr><td>No expenses to show</td></tr>
    <%else%>
      <% @budget_wrapper.categories_with_totals.each do |category_name, total| %>
        <tr>
          <td><%=category_name%></td>
          <td>£ <%=total%></td>
        </tr>
      <%end%>
    <%end%>
  </table>
  <h3>Expenses</h3>
  <% if @budget_wrapper.budget.current? %>
    <div class='well'>
      <form class= 'form-inline' id='cost_form' role='form' method='post' action='/cost'>
        <div class='form-group'>
          <label for='name'>Date</label>
          <input type='text' class='form-control' name='cost_date'>
        </div>
        <div class='form-group'>
          <label for='name'>Description</label>
          <input type='text' class='form-control' name='cost_desc'>
        </div>
        <div class='form-group'>
          <label for='name'>Price</label>
          <input type='text' class='form-control' name='cost_price'>
        </div>
        <div class='form-group'>
          <select class="form-control" id="categories_list" name='cost[category_id]'>
            <option value='unselected'> Please select a category </option>
            <% Category.all_names.each do |cat_name| %>
              <option value='<%=cat_name%>'><%=cat_name%></option>
            <%end%>
          </select>
        </div>
        <div class='form-group'>
          <input class="btn btn-success" type="submit" value="Add new cost">
        </div>
      </form>
    </div>
  <h4>Existing expenses</h4>
  <%end%>
  <table class="table table-striped table-hover table-condensed">
    <tr>
      <th>Date</th>
      <th>Description</th>
      <th>Price</th>
      <th>Category</th>
      <th>&nbsp;</th>
    </tr>
    <% if !@budget_wrapper.costs.nil? %>
      <% @budget_wrapper.costs.each do |cost| %>
        <tr>
          <td><%=cost.formatted_date%></td>
          <td><%=cost.description%></td>
          <td>£ <%=cost.price%></td>
          <td><%=cost.category.name%></td>
        </tr>
      <%end%>
    <%end%>
  </table>
</div>
